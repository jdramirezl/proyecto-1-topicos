syntax = "proto3";
option go_package = "proto/cluster/;cluster";

import "google/protobuf/empty.proto";

enum Type {
    QUEUE = 0;
    TOPIC = 1;
}

message SystemRequest(){
    string id = 0;
    string name = 1;
    Type type = 2;
    string creator = 3;
}

message SubscriberRequest {
    string name = 1;
    Type type = 2;
    string ip = 3;
}

message PeerRequest {
    string ip = 1;
}

message PeerRequest {
    string ip = 1;
}

message MasterRequest {
    string ip = 1;
}

message PeerResponse {
    repeated string ip = 1;
}

message electLeaderResponse {
    int64 uptime = 1;
}

service ClusterService {
    rpc addMessagingSystem(SystemRequest) returns (google.protobuf.Empty) {};
    rpc removeMessagingSystem(SystemRequest) returns (google.protobuf.Empty) {};

    rpc addSubscriber(SubscriberRequest) returns (google.protobuf.Empty) {};
    rpc removeSubscriber(SubscriberRequest) returns (google.protobuf.Empty) {};

    rpc addConnection(ConnectionRequest) returns (google.protobuf.Empty) {};
    rpc removeConnection(ConnectionRequest) returns (google.protobuf.Empty) {};

    rpc addPeer(PeerRequest) returns (PeerResponse) {};
    rpc removePeer(PeerRequest) returns (google.protobuf.Empty) {};

    rpc newMaster (MasterRequest) return (google.protobuf.Empty);
    rpc heartbeat (google.protobuf.Empty) return (google.protobuf.Empty);
    
    rpc electLeader (google.protobuf.Empty) return (electLeaderResponse);
}
